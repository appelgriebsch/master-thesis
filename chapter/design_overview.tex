%!TEX root = ../MasterThesis.tex

\section{Concept of System}
\label{sec:system_concept}

Based on the explanations in Chapter~\ref{cha:context_analysis}, and especially the scope definition for this Master thesis in Section~\ref{sec:scope_thesis}, the collaborative system for investigating \gls{E-commerce} fraud incidents have to answer the central question:\@

\begin{quotation}
  \textit{Is this really a valid \gls{E-commerce} transaction?}
\end{quotation}

The relevant stakeholders, that need to be involved in the investigation process, are:\@

\begin{enumerate}
    \item \textbf{merchant}, who can provide additional information of each \gls{E-commerce} transaction in question
    \item \textbf{\gls{PSP}/issuer}, that have information about the credit card usage patterns and the original credit card owner
    \item \textbf{\gls{LSP}}, who can offer information about whether the order has already been shipped or not, and in the former case to whom it has been handed over
\end{enumerate}

Ideally each of them would make parts of their internal data structures available for the other participants to access and query for information. This would allow the stakeholder, who has to authorize or validate a suspicious credit card payment, to analyze all available information, as depicted in the Figure~\ref{fig:images_system_overview}.\@

\begin{figure}[H]
	\centering
		\includegraphics[width=0.9\columnwidth]{images/system_overview.pdf}
	\caption{High-level concept of the system}
\label{fig:images_system_overview}
\end{figure}

Due to the fact that data from various sources have to be combined into a shared understanding of the \gls{E-commerce} activities of a consumer, there is an urgent need to harmonize and transform the information into a shared data model. Based on the discussions in Chapter~\ref{cha:context_analysis}, and the analysis of the information each stakeholder holds and transmits to others, the following initial data relationships can be conducted for the \gls{E-commerce} scenario (see Figure~\ref{fig:images_data_model}). This figure shows not only the relevant information from the local contexts of each stakeholder, but also how they can be combined within a shared information space. \\

\begin{figure}[!ht]
  \centering
  \includegraphics[width=0.9\columnwidth]{images/ontology_scenario_1.pdf}
  \caption[Data relations in the E-commerce scenario]{Data relations in the \gls{E-commerce} scenario\protect\footnotemark}
\label{fig:images_data_model}
\end{figure}

As one can see there are connection points between these stakeholders. Those can be used as a reference for joining the distributed information into a combined view of the \gls{E-commerce} transaction. There are actually three major connection points: \@

\begin{enumerate}
  \item \textbf{payment token}: shared between merchant and \gls{PSP}
  \item \textbf{tracking number}: shared between merchant and \gls{LSP}
  \item \textbf{credit card}: shared between issuer and \gls{PSP}
\end{enumerate}

In addition to these connection points one can also see the important validation points in the Figure~\ref{fig:images_data_model}. These are points that have an influence on the decision whether an \gls{E-commerce} transaction is evaluated as suspicious or not. The two main criteria are: \@

\begin{enumerate}
  \item \textbf{billing address}: the billing address of the order has to match the registered address of the owner of the credit card used
  \item \textbf{recipient}: the recipient of the delivery has to be related to the owner of the credit card
\end{enumerate}

\footnotetext{Legend: green: issuer, red: \gls{PSP}, yellow: merchant, blue: \gls{LSP}}

Whereas the first criteria can be examined during the authorization process of the credit card payment based on the information transmitted between merchant and \gls{PSP}, the second one is more difficult to validate (or can not be verified at all). The only check the \gls{LSP} is able to do, before they are handing over the packaged items to the recipients, is to verify that they are the ones mentioned in the order. If they are somehow related to the owner of the credit card, or just a deceiver misusing the credit card data can not be confirmed at that point. \\

Also the merchants, the \gls{PSP}s and issuers have no clue. Whereas the merchants are able to validate whether a consumer has send items to that shipping address before, they can not restrict a consumer to choose only validated recipient addresses for shipping the order to. Doing so will have a negative impact on the business success of the online merchant. The \gls{PSP}s and issuers can not analyze this situation either, as both participants will not receive the information about the delivery address of an order with the credit card authorization request coming from a merchant. \\

But just sharing the fact whether the shipping and billing address of an order is different between the relevant stakeholders is not enough. Although this information is necessary, it is not sufficient to make a decision about suspicious transactions. Other necessary information are whether the consumer has send orders to this shipping address before, and the information about the content of the current order. Nevertheless, as mentioned in Section~\ref{sec:scope_thesis} looking at just a single transaction of one of the merchants is still not enough to solve the \gls{E-commerce} fraud scenario, that this thesis focuses on. \\

Therefore the idea is to combine the transaction information from various merchants, \gls{LSP}s, \gls{PSP}s and issuers into one large, combined and shared information space to be able to analyze if there are any orders that look extraordinary, and are likely not being made by the owner of the credit card to a certain extend. One can already see that the proposed solution will have to deal with statistical evaluations and probabilities. Starting with the credit card in question the issuers can query for the order details of transactions, that have been done recently with the credit card online. For that they will likely have to query the \gls{PSP}s for the payment tokens first, before asking the merchants for order details to any of those payment tokens. At the end each online transaction can be mapped into a schema like the one shown in Figure~\ref{fig:images_data_model}, building up a large graph of entities and  the relationships between them, having the specific credit card in the center of it. An abbreviated sample graph of this procedure can be seen in Figure~\ref{fig:images_credit_card_graph}. \\

One can clearly recognize the different clusters of transactions by merchant. Still this first collection of the various order information into one large data set is just the beginning of the analysis. Based on the information received the issuer can already filter out transactions, that have been shipped to different addresses than the one the credit card owner is registered for. Especially for those cases it might be worth to ask for additional information from the affected merchants to figure out if the consumer has used these shipping addresses before. As a result the existing graph can be further enriched with supplementary transactional information from merchants at any time if needed. In addition to the address information the issuer can also analyze the item information (incl.\ category, brand and model) of each order. \\

\begin{figure}[!ht]
  \centering
  \includegraphics[width=0.9\columnwidth]{images/ontology_scenario_2.pdf}
  \caption{Clusters of E-commerce transactions by merchant}
\label{fig:images_credit_card_graph}
\end{figure}

But as already stated, analyzing the cluster of transactions from each merchant \textbf{\underline{alone}} will not be sufficient to come up with a solid decision about a suspicious transaction. This is mostly due to the usage pattern of the fraudsters, that have been described in the scenario selected for this Master thesis in Section~\ref{sec:scope_thesis}. Due to this scenario the various order details from the merchants have to be mapped against each other, so that the initial graph can be easily transformed into complementary representations, whose use different criteria to cluster the transactions --- such as recipient addresses, branches of the merchants, or product-related information. This reshaping of the graph can lead to new insights about the ``normal'' shopping behavior of the original credit card owner, and can make deviations from this behavior visible. Visualizing the graph data as a clustered graph on screen supports the explorative nature of knowledge generation and perception, and can help speed up the investigation of the \gls{E-commerce} fraud incidents. An example visualization of a clustered graph is shown in Figure~\ref{fig:images_graph_viz}. \\

\begin{figure}[!ht]
  \centering
  \includegraphics[width=0.9\columnwidth]{images/GraphViz.png}
  \caption[An example visualization of a clustered graph]{An example visualization of a clustered graph \citep{visjsshowcase}}
\label{fig:images_graph_viz}
\end{figure}

 In addition to these clustered graphs the system can also support the investigation of the incidents by changing the type of visualization used based on the criteria chosen for the clustering of the order details; e.g.\ when clustering them based on location information such as the shipping addresses the system can present the information as a heat map on a chart such as displayed in Figure~\ref{fig:images_map_heatmap}. \@

\begin{figure}[H]
  \centering
  \includegraphics[width=0.9\columnwidth]{images/Heatmap.png}
  \caption{Heatmap displaying clusters of location-based information}
\label{fig:images_map_heatmap}
\end{figure}

To conclude the system have to support the collection and combination of \gls{E-commerce} transaction information from various sources into a large clustered graph, that can be analyzed from multiple view points to validate, if there is any transaction that stands out from the ``normal'' shopping behavior of the original credit card owner. The starting point is a sequence of recent credit card activities, that the issuer can provide to the other participants. The initial graph will collect and cluster the information from each merchant based on this list. In case there are suspicious information in one of the clusters of the merchants, the issuer can ask for further details and enrich that specific cluster with additional order details for this customer and that merchant. In the final step the system has to do the mapping of the order detail information between each merchant to allow subsequent analyzing and clustering of the transactions.

% section system_overview (end)
